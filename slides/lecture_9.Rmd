---
title: "Convergence of random variables"
author: "Ciaran Evans"
output: beamer_presentation
---

## Warmup

Work on the warmup activity (handout), then we will discuss as a class.

\vspace{4cm}

## Warmup

Let $X_1, X_2, ...$ be iid random variables with $\mathbb{E}[X_i] = \mu$ and $Var(X_i) = \sigma^2 < \infty$.

$$ 
\begin{aligned}
\mathbb{E}[\overline{X}_n] &= \mathbb{E}\left[\frac{1}{n} \sum \limits_{i=1}^n X_i\right] = \hspace{8cm} \\
Var(\overline{X}_n) &= Var\left(\frac{1}{n} \sum \limits_{i=1}^n X_i\right) =
\end{aligned}
$$

$$
P(|\overline{X}_n - \mu| \geq \varepsilon) \leq \hspace{8cm}
$$

## Convergence in probability

**Definition:** A sequence of random variables $X_1, X_2,...$ *converges in probability* to a random variable $X$ if, for every $\varepsilon > 0$,
$$\lim \limits_{n \to \infty} P(|X_n - X| \geq \varepsilon) = 0$$
We write $X_n \overset{p}{\to} X$.

\vspace{2cm}

**Weak Law of Large Numbers (WLLN):** Let $X_1, X_2, ...$ be iid random variables with $\mathbb{E}[X_i] = \mu$ and $Var(X_i) = \sigma^2 < \infty$. Then
$$\overline{X}_n \overset{p}{\to} \mu$$

## Example: WLLN

Suppose $X_1, X_2,... \overset{iid}{\sim} N(0, 1)$. Then $\overline{X}_n \sim N(0, \frac{1}{n})$. Let $\varepsilon = 0.5$.

```{r, echo=F, message=F, warning=F}
library(latex2exp)
library(tidyverse)
library(patchwork)

# 2 * pnorm(-0.5)
gridpts <- seq(-2, 2, 0.001)
y <- dnorm(gridpts)
p1 <- data.frame(gridpts, y) |>
  ggplot(aes(x = gridpts, y = y)) +
  geom_line() +
  geom_vline(xintercept = c(-0.5, 0.5), color = "orange") +
  geom_vline(xintercept = 0, color="grey", lty=2) +
  theme_classic() +
  labs(x = "x", y = "density", 
       title = TeX(r'(n = 1, $P(|\bar{X}_n - 0| \geq 0.5) = 0.617$)'))

y <- dnorm(gridpts, sd=sqrt(1/10))
# 2 * pnorm(-0.5, sd=sqrt(1/10))
p2 <- data.frame(gridpts, y) |>
  ggplot(aes(x = gridpts, y = y)) +
  geom_line() +
  geom_vline(xintercept = c(-0.5, 0.5), color = "orange") +
  geom_vline(xintercept = 0, color="grey", lty=2) +
  theme_classic() +
  labs(x = "x", y = "density", 
       title = TeX(r'(n = 10, $P(|\bar{X}_n - 0| \geq 0.5) = 0.114$)'))


y <- dnorm(gridpts, sd=sqrt(1/50))
# 2 * pnorm(-0.5, sd=sqrt(1/50))
p3 <- data.frame(gridpts, y) |>
  ggplot(aes(x = gridpts, y = y)) +
  geom_line() +
  geom_vline(xintercept = c(-0.5, 0.5), color = "orange") +
  geom_vline(xintercept = 0, color="grey", lty=2) +
  theme_classic() +
  labs(x = "x", y = "density", 
       title = TeX(r'(n = 50, $P(|\bar{X}_n - 0| \geq 0.5) = 0.0004$)'))

y <- dnorm(gridpts, sd=sqrt(1/100))
# 2 * pnorm(-0.5, sd=sqrt(1/100))
p4 <- data.frame(gridpts, y) |>
  ggplot(aes(x = gridpts, y = y)) +
  geom_line() +
  geom_vline(xintercept = c(-0.5, 0.5), color = "orange") +
  geom_vline(xintercept = 0, color="grey", lty=2) +
  theme_classic() +
  labs(x = "x", y = "density", 
       title = TeX(r'(n = 100, $P(|\bar{X}_n - 0| \geq 0.5) = 0.00000057$)'))

(p1 + p2)/(p3 + p4)
```



## Example

Let $U \sim Uniform(0, 1)$, and let $X_n = \sqrt{n} \ \mathbb{I} \{U \leq 1/n \}$.

Then $X_n \overset{p}{\to} 0$.

\vspace{5cm}


## Class activity, Part I

Work on the class activity (handout), then we will discuss as a class.

\vspace{4cm}

## Class activity, Part I


Suppose that $X_1, X_2, ... \overset{iid}{\sim} Uniform(0, 1)$, and let $X_{(n)} = \max\{X_1,...,X_n\}$. Then $X_{(n)} \overset{p}{\to} 1$.

\vspace{6cm}

## Class activity, Part I

Suppose that $X_1, X_2, ... \overset{iid}{\sim} Uniform(0, 1)$. Then $X_{(n)} \sim Beta(n, 1)$


```{r, echo=F, message=F, warning=F}
n <- 1
gridpts <- seq(0, 1, 0.001)
y <- dbeta(gridpts, shape1 = n, shape2 = 1)
p1 <- data.frame(gridpts, y) |>
  ggplot(aes(x = gridpts, y = y)) +
  geom_line() +
  geom_vline(xintercept = c(0.95), color = "orange") +
  geom_vline(xintercept = 1, color="grey", lty=2) +
  theme_classic() +
  labs(x = "x", y = "density", 
       title = TeX(r'(n = 1, $P(|X_{(n)} - 1| \geq 0.05) = 0.95$)'))

n <- 10
y <- dbeta(gridpts, shape1 = n, shape2 = 1)
p2 <- data.frame(gridpts, y) |>
  ggplot(aes(x = gridpts, y = y)) +
  geom_line() +
  geom_vline(xintercept = c(0.95), color = "orange") +
  geom_vline(xintercept = 1, color="grey", lty=2) +
  theme_classic() +
  labs(x = "x", y = "density", 
       title = TeX(r'(n = 10, $P(|X_{(n)} - 1| \geq 0.05) = 0.60$)'))

n <- 50
y <- dbeta(gridpts, shape1 = n, shape2 = 1)
p3 <- data.frame(gridpts, y) |>
  ggplot(aes(x = gridpts, y = y)) +
  geom_line() +
  geom_vline(xintercept = c(0.95), color = "orange") +
  geom_vline(xintercept = 1, color="grey", lty=2) +
  theme_classic() +
  labs(x = "x", y = "density", 
       title = TeX(r'(n = 50, $P(|X_{(n)} - 1| \geq 0.05) = 0.077$)'))

n <- 100
y <- dbeta(gridpts, shape1 = n, shape2 = 1)
p4 <- data.frame(gridpts, y) |>
  ggplot(aes(x = gridpts, y = y)) +
  geom_line() +
  geom_vline(xintercept = c(0.95), color = "orange") +
  geom_vline(xintercept = 1, color="grey", lty=2) +
  theme_classic() +
  labs(x = "x", y = "density", 
       title = TeX(r'(n = 100, $P(|X_{(n)} - 1| \geq 0.05) = 0.006$)'))


(p1 + p2)/(p3 + p4)
```

## Class activity, Part II

Suppose that $X_1, X_2, ... \overset{iid}{\sim} Exp(1)$, and let $Y_{n} = \min\{X_1,...,X_n\}$. Then $Y_n \sim Exp(n)$, and $Y_n \overset{p}{\to} 0$.

\vspace{6cm}





